process {
    errorStrategy = { task.exitStatus in ((130..145) + 104 + 125) ? "retry" : "finish" }
    maxRetries    = 0
    maxErrors     = "-1"

    cpus = 1
    memory = 6.GB
    time = 2.h

    withLabel:download_env {
        container = "us-east1-docker.pkg.dev/c-tc-429521/sc-recounter-download/sc-recounter-download:0.1.0"
        conda = "envs/download.yml"
    }
    withLabel:read_env {
        container = "us-east1-docker.pkg.dev/c-tc-429521/sc-recounter-download/sc-recounter-download:0.1.0"
        conda = "envs/read_qc.yml"
    }
    withLabel:star_env {
        container = "us-east1-docker.pkg.dev/c-tc-429521/sc-recounter-star/sc-recounter-star:0.1.0"
        conda = "envs/star.yml"
    }

    withLabel:process_long {
        cpus = 2
        memory = { 12.GB * task.attempt }
        time = { 48.h * task.attempt }
    }
    withLabel:process_low {
        cpus = 4
        memory = { 12.GB * task.attempt }
        time = { 4.h * task.attempt }
    }
    withLabel:process_low_long {
        cpus = 8
        memory = { 18.GB * task.attempt }
        time = { 48.h * task.attempt }
    }
    withLabel:process_medium {
        cpus = 8
        memory = { 36.GB * task.attempt }
        time = { 8.h * task.attempt }
    }
    withLabel:process_high {
        cpus = 14
        memory = { 72.GB * task.attempt }
        time = { 12.h * task.attempt }
        maxRetries = 3
    }
}

